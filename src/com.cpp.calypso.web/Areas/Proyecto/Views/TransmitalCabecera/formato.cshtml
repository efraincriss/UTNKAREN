@model com.cpp.calypso.web.Areas.Proyecto.Models.TransmitalCabeceraDetalleViewModel

@{
    ViewBag.Title = "formato";
    Layout = null;
} 
<div class="card" style="width:  100%;">

    <div class="card-body form" id="dvData" style="width:  100%;">
        <div id="cust">
            <table border="2" id="tblReporte">
                <tbody>
                    <tr>
                        <td colspan="2">

                            <img src="~/Views/Shared/cpp.jpg" />
                        </td>
                        <td colspan="5" align="center"> <H3> TRANSMISIÓN DE DATOS (TD) </H3></td>
                        <td colspan="2"> <img src="~/Views/Shared/arbol.jpg" height="70px" /></td>

                    </tr>
                    <tr>
                        <td colspan="9" align="left"><b>Hoja 01 de 01</b></td>

                    </tr>
                    <tr>
                        <td colspan="3"><b>TD N°:</b></td>
                        <td colspan="6">@Model.TransmitalCabecera.codigo_transmital</td>

                    </tr>
                    <tr>
                        <td colspan="3"><b>Fecha:</b></td>
                        <td colspan="6">@DateTime.Now.ToString("dd/MM/yyyy")</td>

                    </tr>
                    <tr>
                        <td colspan="3"><b>Contrato:</b></td>
                        @if (Model.TransmitalCabecera.OfertaComercialId > 0)
                        {
                            <td colspan="6">@Model.TransmitalCabecera.Contrato.objeto</td>
                        }


                    </tr>
                    <tr>
                        <td colspan="2"><b>De:</b></td>
                        <td colspan="4">@Model.TransmitalCabecera.enviado_por</td>
                        <td colspan="2"><b>Para:</b></td>
                        <td colspan="1">@Model.TransmitalCabecera.dirigido_a</td>

                    </tr>
                    <tr>
                        <td colspan="2"><b>Con Copia:</b></td>
                        <td colspan="7">@Model.TransmitalCabecera.copia_a</td>

                        <br />
                    </tr>
                    <tr>
                        <td colspan="9" align="center"><b>DOCUMENTOS ENTREGADOS</b></td>

                    </tr>
                    <tr align="center">

                        <td align="center"><b>N°</b></td>
                        <td align="center"><b>Código</b></td>
                        <td align="center"><b>Título</b></td>
                        <td align="center"><b>Rev</b></td>
                        <td align="center"><b>Hojas</b></td>
                        <td align="center"><b>Copias</b></td>
                        <td align="center"><b>FO</b></td>
                        <td align="center"><b>PR</b></td>
                        <td align="center"><b>TI</b></td>
                        @{var a = 1; }
                        @foreach (var item in Model.DetallesTransmital)
                        {

                        <tr>
                            <td align="center">@a</td>
                            <td align="center"> @Html.DisplayFor(modelItem => item.codigo_detalle)</td>
                            <td align="center" style="width: 600px"> @Html.DisplayFor(modelItem => item.descripcion)</td>
                            <td align="center" style="width: 100px"> @Html.DisplayFor(modelItem => item.version)</td>
                            <td align="center" style="width: 100px"> @Html.DisplayFor(modelItem => item.nro_hojas)</td>
                            <td align="center" style="width: 100px"> @Html.DisplayFor(modelItem => item.nro_copias)</td>
                            <td align="center" style="width: 100px"></td>
                            <td align="center" style="width: 100px"> </td>
                            <td align="center" style="width: 100px"></td>
                        </tr>
                        a = a + 1;
                    }

                        </tr>


                        <tr>
                            <td colspan="9">&nbsp;</td>


                        </tr>
                        <tr>
                            <td colspan="3"><b>CONTROL DE DOCUMENTOS CPP</b><br />Nombre:</td>
                            <td colspan="4"><b>FIRMA:</b></td>
                            <td colspan="2"><b>FECHA:  @DateTime.Now.ToString("dd/MM/yyyy")</b></td>

                        </tr>
                        <tr>
                            <td colspan="3"><b>CONTROL DE DOCUMENTOS SHAYA</b><br />Nombre:</td>
                            <td colspan="4"><b>FIRMA: </b></td>
                            <td colspan="2"><b>FECHA: @DateTime.Now.ToString("dd/MM/yyyy") </b></td>

                        </tr>
                        <tr>



                        <tr>
                            <br />
                            <td colspan="9" align="center"><b>COMENTARIOS</b></td>

                        </tr>
                        <tr>
                            <td colspan="9" align="center">Sin Comentarios o Pendiente</td>

                        </tr>
                        <br />
                        <tr>
                            <td colspan="9" align="center"></td>

                        </tr>
                        <tr>
                            <td colspan="3"><b>Formato (Fo)</b></td>
                            <td colspan="3"><b>Propósito(Pr)</b></td>
                            <td colspan="3"><b>Tipo (Ti)</b></td>

                        </tr>
                        <tr>
                            <td colspan="3" align="justify">
                                (P) Papel<br />
                                (I) Informático<br />
                                (X) Extranet
                            </td>
                            <td colspan="3">
                                (PI) Para Información<br />
                                (PC) Para Compras<br />
                                (PA) Para Aprobación
                            </td>
                            <td colspan="3">
                                (MI) Minuta de Reunión<br />
                                (TQ) Consulta Técnica<br />
                                (PR) Procedimiento<br />
                                (Lt) Carta<br />
                                (OT) Otros<br />
                                (CO) Comercial
                            </td>

                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div hidden="hidden" id="PDFcontent">
        <h3>Exportación Pdf</h3>
        <p>Tabla Transmital Pendiente</p>
        <table>
            <tbody>
                <tr>
                    <td colspan="2">

                        hola
                    </td>
                    <td colspan="5" align="center"> <H3> TRANSMISIÓN DE DATOS (TD) </H3></td>
                    <td colspan="2"> hola</td>

                </tr>
                <tr>
                    <td colspan="3"><b>TD NRO:</b></td>
                    <td colspan="6">@Model.TransmitalCabecera.codigo_transmital</td>

                </tr>
                <tr>
                    <td colspan="3"><b>Contrato:</b></td>
                    @if (Model.TransmitalCabecera.OfertaComercialId > 0) {
                    <td colspan="6">@Model.TransmitalCabecera.OfertaComercial.codigo</td>
                    }

                </tr>
                <tr>
                    <td colspan="2"><b>De:</b></td>
                    <td colspan="4">@Model.TransmitalCabecera.enviado_por</td>
                    <td colspan="2"><b>Para:</b></td>
                    <td colspan="1">@Model.TransmitalCabecera.dirigido_a</td>

                </tr>
                <tr>
                    <td colspan="2"><b>Con Copia:</b></td>
                    <td colspan="7">@Model.TransmitalCabecera.copia_a</td>

                    <br />
                </tr>
                <tr>
                    <td colspan="9" align="center"><b>DOCUMENTOS ENTREGADOS</b></td>

                </tr>
                <tr align="center">

                    <td align="center"><b>Nro</b></td>
                    <td align="center"><b>Código</b></td>
                    <td align="center"><b>Título</b></td>
                    <td align="center"><b>Rev</b></td>
                    <td align="center"><b>Hojas</b></td>
                    <td align="center"><b>Copias</b></td>
                    <td align="center"><b>FO</b></td>
                    <td align="center"><b>PR</b></td>
                    <td align="center"><b>TI</b></td>

                    @foreach (var item in Model.DetallesTransmital)
                    {
                    <tr>
                        <td align="center">#</td>
                        <td align="center"> @Html.DisplayFor(modelItem => item.codigo_detalle)</td>
                        <td align="center" style="width: 600px"> @Html.DisplayFor(modelItem => item.descripcion)</td>
                        <td align="center" style="width: 100px"> @Html.DisplayFor(modelItem => item.version)</td>
                        <td align="center" style="width: 100px"> @Html.DisplayFor(modelItem => item.nro_hojas)</td>
                        <td align="center" style="width: 100px"> @Html.DisplayFor(modelItem => item.nro_copias)</td>
                        <td align="center" style="width: 100px"></td>
                        <td align="center" style="width: 100px"></td>
                        <td align="center" style="width: 100px"> </td>
                    </tr>
                }

                    </tr>


                    <tr>
                        <td colspan="9">&nbsp;</td>


                    </tr>
                    <tr>
                        <td colspan="3"><b>CONTROL DE DOCUMENTOS CPP</b><br />Nombre:</td>
                        <td colspan="4"><b>FIRMA:</b></td>
                        <td colspan="2"><b>FECHA:  @Model.TransmitalCabecera.fecha_emision</b></td>

                    </tr>
                    <tr>
                        <td colspan="3"><b>CONTROL DE DOCUMENTOS SHAYA</b><br />Nombre:</td>
                        <td colspan="4"><b>FIRMA: </b></td>
                        <td colspan="2"><b>FECHA: @Model.TransmitalCabecera.fecha_emision </b></td>

                    </tr>
                    <tr>



                    <tr>
                        <br />
                        <td colspan="9" align="center"><b>COMENTARIOS</b></td>

                    </tr>
                    <tr>
                        <td colspan="9" align="center">Sin Comentarios o Pendiente</td>

                    </tr>
                    <br />
                    <tr>
                        <td colspan="9" align="center"></td>

                    </tr>
                    <tr>
                        <td colspan="3"><b>Formato (Fo)</b></td>
                        <td colspan="3"><b>Propósito(Pr)</b></td>
                        <td colspan="3"><b>Tipo (Ti)</b></td>

                    </tr>
                    <tr>
                        <td colspan="3" align="justify">
                            (P) Papel<br />
                            (I) Informático<br />
                            (X) Extranet
                        </td>
                        <td colspan="3">
                            (PI) Para Información<br />
                            (PC) Para Compras<br />
                            (PA) Para Aprobación
                        </td>
                        <td colspan="3">
                            (MI) Minuta de Reunión<br />
                            (TQ) Consulta Técnica<br />
                            (PR) Procedimiento<br />
                            (Lt) Carta<br />
                            (OT) Otros<br />
                            (CO) Comercial
                        </td>

                    </tr>
                </tbody>
            </table>
        </div>
        <div id="editor"></div>

        @section Scripts{
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
            <script>

                var doc = new jsPDF();
                var specialElementHandlers = {
                    '#editor': function (element, renderer) {
                        return true;
                    }
                };

                $('#expdf').click(function () {
                    doc.fromHTML($('#PDFcontent').html(), 10, 10, {
                        'width': 110,
                        'elementHandlers': specialElementHandlers
                    });
                    doc.save('transmital.pdf');
                });
                $("#btnExport").click(function (e) {
                    window.open('data:application/vnd.ms-excel;charset=utf-8,%EF%BB%BF"' + encodeURIComponent($('#dvData').html()));
                    e.preventDefault();
                });



            </script>}